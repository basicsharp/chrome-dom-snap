<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DOM Snap - Hot Reload Test Page</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
    }

    .section {
      background: #f5f5f5;
      padding: 20px;
      margin: 20px 0;
      border-radius: 8px;
      border-left: 4px solid #007acc;
    }

    .counter {
      font-size: 24px;
      font-weight: bold;
      color: #007acc;
      padding: 10px;
      background: white;
      border-radius: 4px;
      margin: 10px 0;
    }

    button {
      background: #007acc;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      margin: 5px;
    }

    button:hover {
      background: #005a99;
    }

    input,
    textarea,
    select {
      padding: 8px;
      margin: 5px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    textarea {
      width: 100%;
      height: 80px;
      resize: vertical;
    }

    .status {
      padding: 10px;
      border-radius: 4px;
      margin: 10px 0;
    }

    .success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }

    .warning {
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }

    .animated {
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% {
        opacity: 1;
      }

      50% {
        opacity: 0.5;
      }

      100% {
        opacity: 1;
      }
    }

    .log {
      background: #000;
      color: #0f0;
      padding: 10px;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      height: 150px;
      overflow-y: auto;
      margin: 10px 0;
    }
  </style>
</head>

<body>
  <h1>ğŸš€ DOM Snap - Hot Reload Test Page</h1>

  <div class="status info">
    <strong>Instructions:</strong>
    <ol>
      <li>Interact with the elements below (change values, click buttons, scroll)</li>
      <li>Take a snapshot using the DOM Snap extension</li>
      <li>Modify some elements (change text, counter values, form inputs)</li>
      <li>Restore the snapshot and verify that your state is preserved!</li>
    </ol>
  </div>

  <div class="section">
    <h2>ğŸ“Š JavaScript State Test</h2>
    <div class="counter" id="counter">Counter: 0</div>
    <button onclick="increment()">â• Increment</button>
    <button onclick="decrement()">â– Decrement</button>
    <button onclick="reset()">ğŸ”„ Reset</button>

    <div class="counter" id="timer">Timer: 0s</div>
    <button onclick="startTimer()">â–¶ï¸ Start Timer</button>
    <button onclick="stopTimer()">â¹ï¸ Stop Timer</button>
  </div>

  <div class="section">
    <h2>ğŸ“ Form Data Test</h2>
    <form id="testForm">
      <div>
        <label>Name: <input type="text" name="name" placeholder="Enter your name" /></label>
      </div>
      <div>
        <label>Email: <input type="email" name="email" placeholder="your@email.com" /></label>
      </div>
      <div>
        <label>Age: <input type="number" name="age" min="1" max="120" /></label>
      </div>
      <div>
        <label>Country:
          <select name="country">
            <option value="">Choose...</option>
            <option value="us">United States</option>
            <option value="uk">United Kingdom</option>
            <option value="ca">Canada</option>
            <option value="au">Australia</option>
            <option value="other">Other</option>
          </select>
        </label>
      </div>
      <div>
        <label>Comments:</label>
        <textarea name="comments" placeholder="Enter your thoughts here..."></textarea>
      </div>
      <div>
        <label><input type="checkbox" name="newsletter" /> Subscribe to newsletter</label>
      </div>
      <div>
        <label><input type="radio" name="theme" value="light" /> Light theme</label>
        <label><input type="radio" name="theme" value="dark" /> Dark theme</label>
      </div>
    </form>
  </div>

  <div class="section">
    <h2>ğŸ¯ Focus & Scroll Test</h2>
    <input type="text" id="focusTest" placeholder="Click here and type something..." />
    <button onclick="document.getElementById('focusTest').focus()">Focus Input</button>

    <div style="height: 200px; overflow-y: auto; border: 1px solid #ddd; padding: 10px; margin: 10px 0;" id="scrollBox">
      <div style="height: 800px; background: linear-gradient(to bottom, #ff9a9e, #fecfef, #fecfef, #ff9a9e);">
        <p style="margin: 20px;">Scroll me! This content is taller than the container.</p>
        <p style="margin: 20px;">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
        <p style="margin: 20px;">Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
        <p style="margin: 20px;">Ut enim ad minim veniam, quis nostrud exercitation.</p>
        <p style="margin: 20px;">ğŸ“ Middle marker - scroll here and take a snapshot!</p>
        <p style="margin: 20px;">Duis aute irure dolor in reprehenderit in voluptate.</p>
        <p style="margin: 20px;">Excepteur sint occaecat cupidatat non proident.</p>
        <p style="margin: 20px;">Sunt in culpa qui officia deserunt mollit anim.</p>
        <p style="margin: 400px 20px 20px;">ğŸ¯ Bottom content - if you can see this, you've scrolled!</p>
      </div>
    </div>
  </div>

  <div class="section">
    <h2>ğŸ¨ Dynamic Content Test</h2>
    <button onclick="addItem()">â• Add Item</button>
    <button onclick="removeItem()">â– Remove Item</button>
    <button onclick="changeColors()">ğŸ¨ Change Colors</button>
    <button onclick="toggleAnimation()">âœ¨ Toggle Animation</button>

    <div id="dynamicList"></div>
  </div>

  <div class="section">
    <h2>ğŸ“œ Activity Log</h2>
    <div class="log" id="log"></div>
    <button onclick="clearLog()">ğŸ§¹ Clear Log</button>
  </div>

  <div class="status warning">
    <strong>ğŸ’¡ Testing Tips:</strong>
    <ul>
      <li><strong>Counter Test:</strong> Increment counter, take snapshot, change counter, restore â†’ counter should
        return to snapshot value</li>
      <li><strong>Timer Test:</strong> Start timer, take snapshot, let it run, restore â†’ timer should continue from
        snapshot time</li>
      <li><strong>Form Test:</strong> Fill out form, take snapshot, change values, restore â†’ form should return to
        snapshot state</li>
      <li><strong>Scroll Test:</strong> Scroll to middle, take snapshot, scroll elsewhere, restore â†’ should return to
        middle position</li>
      <li><strong>Focus Test:</strong> Focus input and type, take snapshot, click elsewhere, restore â†’ input should
        regain focus</li>
    </ul>
  </div>

  <script>
    // Global state
    let counter = 0;
    let timerValue = 0;
    let timerInterval = null;
    let itemCounter = 0;
    let isAnimated = false;

    // Utility functions
    function log(message) {
      const logEl = document.getElementById('log');
      const timestamp = new Date().toLocaleTimeString();
      logEl.innerHTML += `[${timestamp}] ${message}\n`;
      logEl.scrollTop = logEl.scrollHeight;
    }

    function clearLog() {
      document.getElementById('log').innerHTML = '';
    }

    // Counter functions
    function increment() {
      counter++;
      document.getElementById('counter').textContent = `Counter: ${counter}`;
      log(`Counter incremented to ${counter}`);
    }

    function decrement() {
      counter--;
      document.getElementById('counter').textContent = `Counter: ${counter}`;
      log(`Counter decremented to ${counter}`);
    }

    function reset() {
      counter = 0;
      document.getElementById('counter').textContent = `Counter: ${counter}`;
      log('Counter reset to 0');
    }

    // Timer functions
    function startTimer() {
      if (timerInterval) return;

      timerInterval = setInterval(() => {
        timerValue++;
        document.getElementById('timer').textContent = `Timer: ${timerValue}s`;
      }, 1000);

      log('Timer started');
    }

    function stopTimer() {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
        log(`Timer stopped at ${timerValue}s`);
      }
    }

    // Dynamic content functions
    function addItem() {
      itemCounter++;
      const list = document.getElementById('dynamicList');
      const item = document.createElement('div');
      item.style.padding = '10px';
      item.style.margin = '5px';
      item.style.background = `hsl(${Math.random() * 360}, 70%, 90%)`;
      item.style.borderRadius = '4px';
      item.textContent = `Dynamic Item #${itemCounter} - Created at ${new Date().toLocaleTimeString()}`;
      if (isAnimated) item.classList.add('animated');
      list.appendChild(item);
      log(`Added dynamic item #${itemCounter}`);
    }

    function removeItem() {
      const list = document.getElementById('dynamicList');
      if (list.children.length > 0) {
        const removed = list.removeChild(list.lastElementChild);
        log(`Removed item: ${removed.textContent.split(' - ')[0]}`);
      }
    }

    function changeColors() {
      const items = document.querySelectorAll('#dynamicList > div');
      items.forEach(item => {
        item.style.background = `hsl(${Math.random() * 360}, 70%, 90%)`;
      });
      log(`Changed colors for ${items.length} items`);
    }

    function toggleAnimation() {
      isAnimated = !isAnimated;
      const items = document.querySelectorAll('#dynamicList > div');
      items.forEach(item => {
        if (isAnimated) {
          item.classList.add('animated');
        } else {
          item.classList.remove('animated');
        }
      });
      log(`Animation ${isAnimated ? 'enabled' : 'disabled'}`);
    }

    // Form change detection
    document.getElementById('testForm').addEventListener('change', (e) => {
      log(`Form field changed: ${e.target.name || e.target.type} = ${e.target.value || (e.target.checked ? 'checked' : 'unchecked')}`);
    });

    // Focus detection
    document.getElementById('focusTest').addEventListener('focus', () => {
      log('Focus test input focused');
    });

    document.getElementById('focusTest').addEventListener('blur', () => {
      log('Focus test input blurred');
    });

    // Scroll detection
    document.getElementById('scrollBox').addEventListener('scroll', (e) => {
      const scrollPercent = Math.round((e.target.scrollTop / (e.target.scrollHeight - e.target.clientHeight)) * 100);
      log(`Scroll box scrolled to ${scrollPercent}%`);
    });

    // Page scroll detection
    let scrollTimeout;
    window.addEventListener('scroll', () => {
      clearTimeout(scrollTimeout);
      scrollTimeout = setTimeout(() => {
        const scrollPercent = Math.round((window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100);
        log(`Page scrolled to ${scrollPercent}%`);
      }, 100);
    });

    // Initialize
    log('Test page loaded and ready! ğŸš€');
    log('Take a snapshot, interact with elements, then restore to test hot reload functionality.');
  </script>
</body>

</html>